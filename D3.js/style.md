# Использование стилей в D3.js

В D3.js можно привязывать стили к элементам несколькими способами: 
  - прямое задание стилей (`style`)
  - через атрибуты (`attr`)   
  - CSS-классы (`classed`)  
  
---

## **1. Использование `.style()` — прямое задание стилей**  
Можно динамически применять стили к элементам, используя метод `.style(property, value)`.  

### **Пример:**  
```js
d3.select("body")
  .append("div")
  .text("Привет, D3!")
  .style("color", "red")
  .style("font-size", "20px")
  .style("background-color", "#f0f0f0");
```
**Плюсы:**  
- Подходит для инлайновых стилей.  
- Можно задавать стили динамически на основе данных.  

**Минусы:**  
- Не использует CSS-классы, что усложняет переопределение стилей.  

---

## **2. Использование `.attr("class", "...")` или `.classed()` — работа с CSS-классами**  
Лучше вынести стили в CSS, а в D3 только добавлять/удалять классы.  

### **Через `.attr("class", "my-class")`**  
```js
d3.select("circle")
  .attr("class", "highlight");
```
**CSS:**  
```css
.highlight {
  fill: red;
  stroke: black;
  stroke-width: 2px;
}
```

### **Через `.classed("class-name", true/false)`**  
Можно добавлять/удалять классы динамически:  
```js
d3.selectAll("circle")
  .classed("highlight", true); // добавляет класс
```
**Пример с условием:**  
```js
const data = [10, 20, 30, 40];
const circles = d3.select("svg")
  .selectAll("circle")
  .data(data)
  .enter()
  .append("circle")
  .attr("cx", (d, i) => i * 50 + 30)
  .attr("cy", 50)
  .attr("r", d => d)
  .classed("small", d => d < 25) // добавляет класс "small", если d < 25
  .classed("big", d => d >= 25);  // добавляет класс "big", если d >= 25
```
**CSS:**  
```css
.small { fill: blue; }
.big { fill: red; stroke: black; }
```

**Плюсы:**  
- Чистая сепарация стилей и логики.  
- Легко переопределять стили через CSS.  

---

## **3. Динамические стили на основе данных**  
D3 позволяет вычислять стили в зависимости от данных.  

### **Пример:**  
```js
const dataset = [15, 25, 35, 45];
const bars = d3.select("svg")
  .selectAll("rect")
  .data(dataset)
  .enter()
  .append("rect")
  .attr("x", (d, i) => i * 50)
  .attr("y", d => 100 - d)
  .attr("width", 40)
  .attr("height", d => d)
  .style("fill", d => d > 30 ? "red" : "green");
```
→ Бар становится красным, если значение > 30.  

---

## **4. Использование CSS-переменных (для сложных тем)**  
Можно управлять CSS-переменными через D3:  
```js
d3.select("body")
  .style("--main-color", "steelblue");
```
**CSS:**  
```css
circle {
  fill: var(--main-color);
}
```

---

## **Вывод: как лучше привязывать стили?**  
| Метод               | Когда использовать                          |
|---------------------|--------------------------------------------|
| `.style()`          | Инлайновые стили, динамические изменения   |
| `.classed()`        | Управление классами (лучше для CSS)        |
| `.attr("class")`    | Простое добавление класса                  |
| CSS-переменные      | Глобальные темы, сложные стилизации        |

**Рекомендация:**  
- Если стили статические → **выносите в CSS и используйте `.classed()`**.  
- Если стили динамические → **используйте `.style()` или условные классы**.  
- Для сложных тем → **CSS-переменные + D3**.  

Пример на CodePen: [D3.js Styling Examples](https://codepen.io/pen?template=...)