–í D3.js –ø—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `.on()`. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç "–ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è" –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `click`, `mouseover`, `mouseout`, –∏ —Ç.–¥.) –∏ —É–∫–∞–∑–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è.

---

## üìå –û–±—â–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:

```js
selection.on(eventType, eventHandler)
```

* `eventType` ‚Äî —Å—Ç—Ä–æ–∫–∞ —Å —Ç–∏–ø–æ–º —Å–æ–±—ã—Ç–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä: `"click"`, `"mouseover"`, `"keydown"`.
* `eventHandler` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è.

---

## üì• –ê—Ä–≥—É–º–µ–Ω—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è

–§—É–Ω–∫—Ü–∏—è-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ D3 –ø–æ–ª—É—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã:

```js
function(event, d) {
    // event ‚Äî –æ–±—ä–µ–∫—Ç —Å–æ–±—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, MouseEvent)
    // d ‚Äî –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ —ç–ª–µ–º–µ–Ω—Ç—É –¥–∞–Ω–Ω—ã–µ (data-bound datum)
}
```

–¢–∞–∫–∂–µ, –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ `this` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–µ–∫—É—â–∏–π DOM-—ç–ª–µ–º–µ–Ω—Ç, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–≤—è–∑–∞–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫.

---

## üß™ –ü—Ä–∏–º–µ—Ä

```js
d3.selectAll("circle")
  .data([10, 20, 30])
  .on("click", function(event, d) {
    console.log("Clicked value:", d);     // –∑–Ω–∞—á–µ–Ω–∏–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å —ç—Ç–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º
    console.log("Event object:", event);  // MouseEvent
    console.log("DOM element:", this);    // —Ç–µ–∫—É—â–∏–π <circle>
  });
```

---

## üß† –ö–∞–∫ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã

–ß—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (–Ω–µ `event` –∏ `d`), –æ–±–µ—Ä–Ω–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏—é:

```js
function customHandler(arg1, arg2) {
  return function(event, d) {
    console.log("Custom args:", arg1, arg2);
    console.log("Data:", d);
  };
}

d3.selectAll("rect")
  .data([1, 2, 3])
  .on("mouseover", customHandler("hello", 42));
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Ç—ã –º–æ–∂–µ—à—å –ø—Ä–æ–∫–∏–Ω—É—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –∑–∞–º—ã–∫–∞–Ω–∏–µ.

---

## üß© –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞

–ß—Ç–æ–±—ã —Å–Ω—è—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å `null`:

```js
selection.on("click", null);
```

---


–í D3.js **–Ω–∞ –æ–¥–∏–Ω —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è (`eventType`) –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫** —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `.on()`. –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—ã–∑–æ–≤–µ `.on('click', ...)` ‚Äî –ø—Ä–µ–¥—ã–¥—É—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è**.

---

### üîÅ –ü–æ–≤–µ–¥–µ–Ω–∏–µ `.on()` ‚Äî –≤—Å–µ–≥–¥–∞ **–æ–¥–∏–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è**:

```js
selection
  .on("click", handler1)
  .on("click", handler2);  // handler1 –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ handler2
```

---

### ‚úÖ –ö–∞–∫ –æ–±–æ–π—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏ –≤—ã–∑–≤–∞—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤**

#### üîπ –°–ø–æ—Å–æ–± 1: –í—ã–∑–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞

```js
function handlerA(event, d) {
  console.log("A", d);
}

function handlerB(event, d) {
  console.log("B", d);
}

selection.on("click", function(event, d) {
  handlerA(event, d);
  handlerB(event, d);
});
```

#### üîπ –°–ø–æ—Å–æ–± 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ)

```js
const handlers = [handlerA, handlerB];

selection.on("click", function(event, d) {
  handlers.forEach(fn => fn(event, d));
});
```

---

### üö´ –ü–æ—á–µ–º—É D3 –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ `.on()` –Ω–∞ –æ–¥–Ω–æ —Å–æ–±—ã—Ç–∏–µ –Ω–∞–ø—Ä—è–º—É—é?

D3 –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–π –º–æ–¥–µ–ª–∏: –∫–∞–∂–¥—ã–π `.on(eventType, handler)` ‚Äî —ç—Ç–æ *–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ*, –∞ –Ω–µ *–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ*. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–µ–≥–∫–æ —É–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–≤ `null`.

---

### üß© –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö** —Å–æ–±—ã—Ç–∏–π

D3 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç "–ø–æ–¥—Ç–∏–ø—ã" —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ —Ç–æ—á–∫–∏:

```js
selection.on("click.myHandler", handlerA);
selection.on("click.otherHandler", handlerB);  // –∑–∞–º–µ–Ω–∏—Ç —Ç–æ–ª—å–∫–æ handlerB

// —É–¥–∞–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö:
selection.on("click.myHandler", null);
```

‚û°Ô∏è –í –∏—Ç–æ–≥–µ, –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤** –Ω–∞ –æ–¥–Ω–æ —Å–æ–±—ã—Ç–∏–µ, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ:

```js
selection
  .on("click.a", (e, d) => console.log("A"))
  .on("click.b", (e, d) => console.log("B"));
```

–û–±–∞ –≤—ã–∑–æ–≤—É—Ç—Å—è –ø—Ä–∏ `click`.

---

### ‚úÖ –í—ã–≤–æ–¥:

* `.on("click", ...)` ‚Äî **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç** –ø—Ä–µ–¥—ã–¥—É—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫.
* –ò—Å–ø–æ–ª—å–∑—É–π:

  * –æ–¥–∏–Ω –æ–±—ë—Ä—Ç–æ—á–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –¥—Ä—É–≥–∏–µ;
  * –∏–ª–∏ D3-—Å—Ç–∏–ª–∏—Å—Ç–∏–∫—É —Å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ (`click.ns1`, `click.ns2`).



--- 
–û—Ç–ª–∏—á–Ω–æ! –¢–æ–≥–¥–∞ –¥–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `d3.drag()` ‚Äî —ç—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π **–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å** –≤ D3.js, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è, **–Ω–µ –ø–æ–ª–∞–≥–∞—è—Å—å** –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ `drag`-—Å–æ–±—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞. –û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `mousedown`, `mousemove` –∏ `mouseup`, –∏ **–∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º –æ—Ç HTML5 drag-and-drop API**.

---

## üß± –û—Å–Ω–æ–≤—ã `d3.drag()`

```js
const drag = d3.drag()
  .on("start", dragstarted)
  .on("drag", dragged)
  .on("end", dragended);

d3.select("circle").call(drag);
```

### –°–æ–±—ã—Ç–∏—è:

| –°–æ–±—ã—Ç–∏–µ | –ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è | –ß—Ç–æ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è                    |
| ------- | ---------------- | --------------------------------- |
| `start` | –ø—Ä–∏ `mousedown`  | `event`, `d` (–ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ) |
| `drag`  | –ø—Ä–∏ `mousemove`  | `event`, `d`                      |
| `end`   | –ø—Ä–∏ `mouseup`    | `event`, `d`                      |

---

## üîç –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ `d3.drag()`

* –í–µ—à–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ `mousedown`, `touchstart`.
* –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:

  * —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.
  * —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ `mousemove`/`mouseup` –Ω–∞ `window` (–∏–ª–∏ `document`) –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è.
* –í—ã–∑—ã–≤–∞–µ—Ç —Ç–≤–æ—é —Ñ—É–Ω–∫—Ü–∏—é `on("drag", ...)` –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–∏ –º—ã—à–∏.

---

## üîß –ü—Ä–∏–º–µ—Ä: –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ SVG-–∫—Ä—É–≥–∞

```html
<svg width="400" height="200">
  <circle cx="100" cy="100" r="30" fill="steelblue"></circle>
</svg>
```

```js
const drag = d3.drag()
  .on("start", (event) => {
    d3.select(event.sourceEvent.target).raise().attr("stroke", "black");
  })
  .on("drag", (event) => {
    d3.select(event.sourceEvent.target)
      .attr("cx", event.x)
      .attr("cy", event.y);
  })
  .on("end", (event) => {
    d3.select(event.sourceEvent.target).attr("stroke", null);
  });

d3.select("circle").call(drag);
```

> –ó–¥–µ—Å—å `event.x` –∏ `event.y` ‚Äî —ç—Ç–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫—É—Ä—Å–æ—Ä–∞ —Å —É—á—ë—Ç–æ–º —Å–º–µ—â–µ–Ω–∏—è –∏ zoom/pan, –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ D3.

---

## üìå –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ `d3.drag()`

* –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **touch**-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
* –£—á–∏—Ç—ã–≤–∞–µ—Ç **—Ç–µ–∫—É—â–µ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (zoom/pan)**.
* –†–∞–±–æ—Ç–∞–µ—Ç **–±–µ–∑ interference** —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º HTML5 drag'n'drop API.
* Namespace-–∏–º–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤–Ω—É—Ç—Ä–∏ ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `.drag` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `mousemove.drag`, `mouseup.drag`).

---

## üõ† –°–æ–≤–µ—Ç—ã –ø–æ —Ä–∞–±–æ—Ç–µ

* –ò—Å–ø–æ–ª—å–∑—É–π `d3.event.subject()` (–≤ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö) –∏–ª–∏ `event.subject` –¥–ª—è –∑–∞–¥–∞–Ω–∏—è —Ü–µ–Ω—Ç—Ä–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è.
* –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å `d3.zoom()`, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π –µ–≥–æ —Å `drag` (—á–µ—Ä–µ–∑ `transform`).
* –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `selection.data(...)` ‚Äî —Ç–æ–≥–¥–∞ `d` –≤ `drag(event, d)` –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—ä–µ–∫—Ç–µ.

---



# —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –æ–±—è–≤–ª–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ function() –∏ —Å—Ç—Ä–µ–ª–æ—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –µ—Å—Ç—å –∏ —Ä–∞–∑–Ω–∏—Ü–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–∞—è, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ D3.js. 

–í–æ—Ç –∫–ª—é—á–µ–≤–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ:

---

## üß† –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `function()` –∏ —Å—Ç—Ä–µ–ª–æ—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π `() => {}`

| –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å            | `function(event, d) {}`                                      | `(event, d) => {}`                                           |
| ---------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **`this` –≤–Ω—É—Ç—Ä–∏ —Ç–µ–ª–∞** | –°—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ **DOM-—ç–ª–µ–º–µ–Ω—Ç**, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–≤—è–∑–∞–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ | –ù–∞—Å–ª–µ–¥—É–µ—Ç `this` –∏–∑ –≤–Ω–µ—à–Ω–µ–π –æ–±–ª–∞—Å—Ç–∏ (–Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ DOM)      |
| **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å D3** | ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç, —Ç.–∫. –Ω—É–∂–µ–Ω `this` –¥–ª—è `d3.select(this)` | ‚ö†Ô∏è `this` –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç ‚Äî –Ω–µ–ª—å–∑—è `d3.select(this)` |

---

## üìå –ü–ø—Ä–∏–º–µ—Ä:

```js
.on("start", function(event, d) {
  d3.selectAll("circle.selected").each(function(d) {
    d.ox = d.cx;
    d.oy = d.cy;
  });
});
```

* –ó–¥–µ—Å—å `function(...) {}` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ:

  * `this` –≤–Ω—É—Ç—Ä–∏ `each(...)` ‚Äî —ç—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π `<circle>`.
  * –ò —Ç—ã –º–æ–∂–µ—à—å –¥–µ–ª–∞—Ç—å `d3.select(this)` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `this` –Ω–∞–ø—Ä—è–º—É—é.

---

## ‚ùå –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å—Ç—Ä–µ–ª–æ—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é?

```js
.on("start", (event, d) => {
  d3.selectAll("circle.selected").each((d) => {
    d.ox = d.cx;
    d.oy = d.cy;
  });
});
```

* –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ `this` **–Ω–µ –±—É–¥–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ DOM-—ç–ª–µ–º–µ–Ω—Ç**, –∏ —Ç—ã –Ω–µ —Å–º–æ–∂–µ—à—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–¥–µ–ª–∞—Ç—å:

```js
d3.select(this) // ‚ùå this ‚Äî –Ω–µ DOM-—ç–ª–µ–º–µ–Ω—Ç
```

–•–æ—Ç—è —Ç–≤–æ–π –∫–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `this` —è–≤–Ω–æ, –≤–Ω—É—Ç—Ä–∏ `.each(...)` –≤—Å—ë –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `function(d)` ‚Äî –∏ —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ï—Å–ª–∏ –±—ã —Ç—ã –Ω–∞–ø–∏—Å–∞–ª —Å—Ç—Ä–µ–ª–æ—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é **–≤–Ω—É—Ç—Ä–∏** `each(...)`, –æ–Ω–∞ –ø–æ—Ç–µ—Ä—è–ª–∞ –±—ã `this`.

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

* –í D3 **–≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π `function(...)` —Ç–∞–º, –≥–¥–µ –Ω—É–∂–µ–Ω `this`**, –Ω–∞–ø—Ä–∏–º–µ—Ä:

  * `.each(function(d) { ... })`
  * `.on("event", function(event, d) { ... })`

* –°—Ç—Ä–µ–ª–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≥–æ–¥—è—Ç—Å—è –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –∫–æ–¥–∞, –∑–∞–º—ã–∫–∞–Ω–∏–π, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Ç.–ø., –Ω–æ **–Ω–µ** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –≥–¥–µ `this` –Ω—É–∂–µ–Ω.
