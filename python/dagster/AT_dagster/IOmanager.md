

### üí° –ö—Ä–∞—Ç–∫–æ:
- –ú–µ—Ç–æ–¥ `.load_input(context)` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ö–æ–¥–∞** (`input`) –≤ asset –∏–ª–∏ op.
- Dagster —Å–∞–º **—Å–≤—è–∑—ã–≤–∞–µ—Ç —ç—Ç–æ—Ç –≤—ã–∑–æ–≤ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º asset**, –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤ `context` –≤—Å—é –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
- –ò–º–µ–Ω–Ω–æ –≤–Ω—É—Ç—Ä–∏ `load_input()` —Ç—ã **—Ä–µ—à–∞–µ—à—å, –µ—Å—Ç—å –ª–∏ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫—ç—à–µ**, –Ω—É–∂–Ω–æ –ª–∏ –∫–∞—á–∞—Ç—å —Å —É–¥–∞–ª—ë–Ω–∫–∏, –∏ —Ç.–¥.

---

## üîç –î–µ—Ç–∞–ª–∏: —á—Ç–æ –ø–µ—Ä–µ–¥–∞—ë—Ç Dagster –≤ `.load_input(context)`

Dagster –ø–µ—Ä–µ–¥–∞—ë—Ç –≤ `load_input()` –æ–±—ä–µ–∫—Ç `InputContext`, –≤ –∫–æ—Ç–æ—Ä–æ–º –µ—Å—Ç—å:

| –ü–æ–ª–µ                | –ß—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç                                               |
|---------------------|------------------------------------------------------------|
| `context.asset_key` | asset, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —ç—Ç–æ—Ç input (–Ω–∞–ø—Ä–∏–º–µ—Ä, `upstream_asset`) |
| `context.upstream_output` | –û–±—ä–µ–∫—Ç `OutputContext` —Ç–æ–≥–æ asset, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–∞–ª —ç—Ç–æ—Ç input |
| `context.name`      | –∏–º—è –≤—Ö–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `upstream_asset`)                    |
| `context.metadata`  | –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ `@asset`              |
| `context.config`    | –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–∞ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∞—Å—å)                   |

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ç—ã **—Ç–æ—á–Ω–æ –∑–Ω–∞–µ—à—å, –∫–∞–∫–æ–π asset —Ç—ã —Å–µ–π—á–∞—Å –∑–∞–≥—Ä—É–∂–∞–µ—à—å**.

---

## üß† –ü—Ä–∏–º–µ—Ä: asset —Å –≤—Ö–æ–¥–æ–º

```python
@asset
def raw_data() -> pd.DataFrame:
    ...

@asset
def clean_data(raw_data: pd.DataFrame) -> pd.DataFrame:
    ...
```

Dagster –≤—ã–∑–æ–≤–µ—Ç:

```python
load_input(context_for_raw_data_input_to_clean_data)
```

–ò —Ç—ã –º–æ–∂–µ—à—å —Å–¥–µ–ª–∞—Ç—å:

```python
class MyIOManager(IOManager):
    def load_input(self, context: InputContext):
        asset_key = context.asset_key  # —ç—Ç–æ –±—É–¥–µ—Ç 'raw_data'
        path = f"/tmp/cache/{asset_key.to_string()}.pkl"

        if os.path.exists(path):
            return pd.read_pickle(path)
        else:
            remote_path = f"s3://bucket/data/{asset_key.to_string()}.pkl"
            download_from_s3(remote_path, path)
            return pd.read_pickle(path)
```

---

## üì¶ –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö ‚Äî —Ç–æ–∂–µ –∑–¥–µ—Å—å

–¢—ã –º–æ–∂–µ—à—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

- –ø—Ä–æ–≤–µ—Ä–∫—É `mtime`, –µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —É—Å—Ç–∞—Ä–µ–≤–∞—é—Ç
- –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã
- TTL –≤ —Å–µ–∫—É–Ω–¥–∞—Ö/–º–∏–Ω—É—Ç–∞—Ö
- —Ö–µ—à –≤—Ö–æ–¥–æ–≤ (input hash -> output cache)

–≠—Ç–æ **–≤—Å—ë –¥–µ–ª–∞–µ—Ç –∏–º–µ–Ω–Ω–æ `.load_input()`**, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω ‚Äî **—Ç–æ—á–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è —á—Ç–µ–Ω–∏—è**.

---

–ï—Å–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω IOManager, –∫–æ—Ç–æ—Ä—ã–π:
- —Å–º–æ—Ç—Ä–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à
- –µ—Å–ª–∏ —É—Å—Ç–∞—Ä–µ–ª–æ ‚Äî —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏–∑ S3
- –ª–æ–≥–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–∞–∫ `.parquet` –∏–ª–∏ `.pkl` ‚Äî –ø–æ –≤—ã–±–æ—Ä—É